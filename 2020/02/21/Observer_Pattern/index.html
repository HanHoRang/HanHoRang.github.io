<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Observer Pattern - Welcome HoRoang Blog!
        
    </title>

    <link rel="canonical" href="https://hanhorang.github.io/2020/02/21/Observer_Pattern/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('Demo.png')
            /*post*/
        
    }
    
    #signature{
        background-image: url('/img/signature/BeanTechSign-white.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Design Pattern" title="Design Pattern">Design Pattern</a>
                            
                        </div>
                        <h1>Observer Pattern</h1>
                        <h2 class="subheading">Observer Pattern</h2>
                        <span class="meta">
                            Posted by HoRang on
                            2020-02-21
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">HoRang Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2><span id="디자인-패턴">디자인 패턴</span></h2>
<blockquote>
<p>중요한 것은 디자인 패턴에 얽매이는 것이 아니라 그 패턴이 <strong>왜 효율적인 방식인지를 이해</strong>하여야 한다.</p>
</blockquote>
<p>디자인 패턴 두 번째 발표자료이며 <strong>싱글턴, 옵저버 패턴</strong>에 대해 발표하겠습니다.</p>
<p>저는 저번 시간과 같이 패턴에 대해 다음과 같은 관점으로 접근하였습니다.</p>
<ul>
<li>
<p>패턴이 된 원인(어떤 점이 효율적인가), 보완해야할 점(to 잡기술 배우기)</p>
</li>
<li>
<p>패턴이 현대 프로그래밍 언어에서는 어떻게 사용되는가?</p>
</li>
</ul>
<h2><span id="옵저버-패턴">옵저버 패턴</span></h2>
<p><strong>옵저버 패턴</strong>(observer pattern)은 <a href="https://ko.wikipedia.org/wiki/%EA%B0%9D%EC%B2%B4_(%EC%BB%B4%ED%93%A8%ED%84%B0_%EA%B3%BC%ED%95%99)" target="_blank" rel="noopener">객체</a>의 상태 변화를 관찰하는 관찰자들, 즉 옵저버들의 목록을 객체에 등록하여 상태 변화가 있을 때마다 <a href="https://ko.wikipedia.org/wiki/%EB%A9%94%EC%84%9C%EB%93%9C" target="_blank" rel="noopener">메서드</a> 등을 통해 객체가 직접 목록의 각 옵저버에게 통지하도록 하는 <a href="https://ko.wikipedia.org/wiki/%EB%94%94%EC%9E%90%EC%9D%B8_%ED%8C%A8%ED%84%B4" target="_blank" rel="noopener">디자인 패턴</a> 입니다.</p>
<p>**왜 사용할까 ? **</p>
<p>객체 간의 일대 다 종속성 관계를 관리할 때 사용됩니다.</p>
<ul>
<li>객체 간의 밀접한 관계없이 객체 간의 일대 다 종속성을 정의해야 합니다.</li>
<li>하나의 객체가 상태를 변경할 때 개방형 수의 종속 객체가 자동으로 업데이트되도록 해야합니다.</li>
<li>한 객체가 개방 된 수의 다른 객체를 통지 할 수 있어야합니다.</li>
</ul>
<p><strong>어떻게 구현할까?</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observable</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._observers = []</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">register_observer</span><span class="params">(self, observer)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        self._observers.append(observer)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify_observers</span><span class="params">(self, *args, **kwargs)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">for</span> observer <span class="keyword">in</span> self._observers:</span><br><span class="line">            observer.notify(self, *args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, observable)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        observable.register_observer(self)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify</span><span class="params">(self, observable, *args, **kwargs)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        print(<span class="string">'Got'</span>, args, kwargs, <span class="string">'From'</span>, observable)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">subject = Observable()</span><br><span class="line">observer = Observer(subject)</span><br><span class="line">subject.notify_observers(<span class="string">'test'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>주체에 따라 Push, Pull 방식으로 나눠집니다. (자료 보강 필요 ㅠㅠ)</li>
</ul>
<h4><span id="한계">한계</span></h4>
<p>하지만, <strong>옵저버 패턴의 한계</strong>도 존재합니다.</p>
<p>개체 간의 일대 다 종속성 정의는 대상을 특정 종속 개체에 연결하기 때문에 융통성이 없습니다. 이는 성능이 필요한 상황에서는 (초당 수천 번 실행되는 <strong>저수준 커널 구조</strong>를 고려할 때) 고민해봐야할 문제입니다.  밀접하게 연결된 객체는 일부 시나리오에서 구현하기가 어려울 수 있으며 인터페이스가 다른 여러 객체를 참조하고 업데이트하는 방법을 알고 있기 때문에 재사용 할 수 있어 기대하지 않은 결과를 초래할 수 있습니다.</p>
<p>또한, 옵저버 패턴인 경우 메모리 누수를 초래할 수 있습니다.</p>
<blockquote>
<h3><span id="so-what-can-possibly-go-wrong">So what can possibly go wrong?</span></h3>
<p>In a runtime where memory is managed automatically like Java or C#, the <strong>subject holds a strong reference</strong> to the observers, keeping them alive. The strong reference from the subject (the observed object) to the observer, prevents the observer (and any objects it references) from being <strong>garbage collected</strong> until the observer is unregistered. A <strong>memory leak</strong> happens, if the observer fails to unregister from the subject when it no longer needs to receive notifications. In our countdown timer example if observers do not call unregister when they become invisible, they will receive notifications and waste CPU cycles updating invisible UI elements. This issue is called <a href="https://en.wikipedia.org/wiki/Lapsed_listener_problem" target="_blank" rel="noopener">Lapsed Listener Problem</a>.</p>
<p>If you implement the observer pattern in C++ (no garbage collection, memory is managed manually) and you call <strong>delete</strong> on one of the observers without unregistering it from the subject then you are in trouble. Now you have a dangling pointer that points to invalid data. Whenever the subject notifies its observers a <strong>segmentation fault</strong> will be raised.</p>
<h4><span id="always-unregister-your-listeners-unless-they-are-interested-in-receiving-notifications">Always unregister your listeners unless they are interested in receiving notifications.</span></h4>
<p>Another approach for dealing with lapsed listeners (observers) is to use <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/ref/WeakReference.html" target="_blank" rel="noopener">Weak References</a>.</p>
<p>The below implementation of CountDownTimer uses weak references to keep track of registered observers. If the only references to an instance are weak references, then the instance becomes a candidate for Garbage Collection. In contrast to strong references, weak references don’t prevent garbage collector to finilize the instance and reclaim its memory.</p>
</blockquote>
<p>사실 이는 옵저버 패턴뿐만 아니라 OOP 객체를 다룰 때 공통적으로 발생할 수 있는 문제입니다. 단적인 해결방법은 <code>Weakreference</code> 를 사용하여 수동적으로 가비지 컬렉션을 사용한다고 명시하면 예방할 수 있습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> codekata.observer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountDownTimer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> ONE_SECOND = <span class="number">1000L</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> countDownMillis;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> elapsedTimeSinceLastTick;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> totalElapsedTime;</span><br><span class="line">    <span class="keyword">private</span> List&lt;WeakReference&lt;CountDownObserver&gt;&gt; observers = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CountDownTimer</span><span class="params">(<span class="keyword">long</span> initialValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.countDownMillis = initialValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Called every frame</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">long</span> deltaTime)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isFinished()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (totalElapsedTime == <span class="number">0</span>) &#123;</span><br><span class="line">            notifyStart();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        totalElapsedTime += deltaTime;</span><br><span class="line">        elapsedTimeSinceLastTick += deltaTime;</span><br><span class="line">        <span class="keyword">if</span> (elapsedTimeSinceLastTick &gt;= ONE_SECOND) &#123;</span><br><span class="line">            elapsedTimeSinceLastTick = <span class="number">0</span>;</span><br><span class="line">            notifyCountDown();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isFinished()) &#123;</span><br><span class="line">            notifyCountDown();</span><br><span class="line">            notifyFinish();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isFinished</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> totalElapsedTime &gt;= countDownMillis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">notifyCountDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(WeakReference&lt;CountDownObserver&gt; ref : <span class="keyword">this</span>.observers) &#123;</span><br><span class="line">            CountDownObserver observer = ref.get();</span><br><span class="line">            <span class="keyword">if</span> (observer != <span class="keyword">null</span>) &#123;</span><br><span class="line">                observer.onCountDown(</span><br><span class="line">                        totalElapsedTime,</span><br><span class="line">                        Math.max(<span class="number">0</span>, (countDownMillis - totalElapsedTime)));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"!!! DELETED"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">notifyStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(WeakReference&lt;CountDownObserver&gt; ref : <span class="keyword">this</span>.observers) &#123;</span><br><span class="line">            CountDownObserver observer = ref.get();</span><br><span class="line">            <span class="keyword">if</span> (observer != <span class="keyword">null</span>) &#123;</span><br><span class="line">                observer.onStart();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">notifyFinish</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(WeakReference&lt;CountDownObserver&gt; ref : <span class="keyword">this</span>.observers) &#123;</span><br><span class="line">            CountDownObserver observer = ref.get();</span><br><span class="line">            <span class="keyword">if</span> (observer != <span class="keyword">null</span>) &#123;</span><br><span class="line">                observer.onFinish();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerObserver</span><span class="params">(CountDownObserver observer)</span> </span>&#123;</span><br><span class="line">        WeakReference&lt;CountDownObserver&gt; weakReference = findWeakReference(observer);</span><br><span class="line">        <span class="keyword">if</span> (weakReference == <span class="keyword">null</span>) &#123;</span><br><span class="line">            weakReference = <span class="keyword">new</span> WeakReference&lt;&gt;(observer);</span><br><span class="line">            <span class="keyword">this</span>.observers.add(weakReference);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unregisterObserver</span><span class="params">(CountDownObserver observer)</span> </span>&#123;</span><br><span class="line">        WeakReference&lt;CountDownObserver&gt; weakReference = findWeakReference(observer);</span><br><span class="line">        <span class="keyword">if</span> (weakReference != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.observers.remove(weakReference);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> WeakReference&lt;CountDownObserver&gt; <span class="title">findWeakReference</span><span class="params">(CountDownObserver observer)</span> </span>&#123;</span><br><span class="line">        WeakReference&lt;CountDownObserver&gt; weakReference = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">for</span>(WeakReference&lt;CountDownObserver&gt; ref : <span class="keyword">this</span>.observers) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ref.get() == observer) &#123;</span><br><span class="line">                weakReference = ref;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> weakReference;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>자바 고수의 도움이 필요합니다.</li>
</ul>
<p><strong>그럼에도 불구하고…</strong></p>
<p>옵저버 패턴에서의 객체 관리는 <code>링크리스트</code> 로 저장합니다. 하지만 이는 단일 스레드에서만 해당되는 예기로 멀티스레드 상황에서 Thread-safe 상황을 보장하지 못합니다.</p>
<h4><span id="그렇다면-어디에-사용해볼까">그렇다면 어디에 사용해볼까?</span></h4>
<p>대표적으로 MVC 아키텍처에서 사용할 수 있습니다.  MVC 는 Model-View-Controller 로 소프트웨어 디자인 패턴입니다.  사용자 인터페이스로부터 비지니스 로직을 분리하여 애플리케이션의 시각적 요소나 그 이면에서 실행되는 비즈니스 로직을 서로 영향 없이 쉽게 고칠 수 있는 애플리케이션을 만들 수 있습니다.</p>
<p>![Observer Pattern](C:\Users\user\Desktop\공부\CS Study\Design Pattern\Observer Pattern.PNG)</p>
<ul>
<li>Model은 애플리케이션의 정보(데이터)를 나타내며,View는 텍스트, 체크박스 항목 등과 같은 사용자 인터페이스 요소를 나타내고, Controller는 데이터와 비즈니스 로직 사이의 상호동작을 관리한다.</li>
</ul>
<p>MVC가 활용된 예로 Qt, MFC 프레임워크가 있는 데 MFC 프레임워크에서의 옵서버 패턴 사용을 살펴보겠습니다.</p>
<p>![MFC1](C:\Users\user\Desktop\공부\CS Study\Design Pattern\MFC1.PNG)</p>
<ul>
<li>먼저 뷰를 원하는 곳에 배치합니다.</li>
</ul>
<p>![MFC2](C:\Users\user\Desktop\공부\CS Study\Design Pattern\MFC2.PNG)</p>
<ul>
<li>뷰를 배치함과 동시에 컨트롤러 코드가 자동으로 생성됩니다.</li>
</ul>
<p>![MFC3](C:\Users\user\Desktop\공부\CS Study\Design Pattern\MFC3.PNG)</p>
<ul>
<li>컨트롤러 코드를 작성하여 이벤트가 발생했을 시 구현할 내용을 작성합니다.</li>
</ul>
<h4><span id="사용처">사용처?</span></h4>
<p>MVC 같은 경우 기능의 On/OFF 인 상태가 다수일 경우 사용하기 좋습니다.  곰플레이어에서의 동영상 관련 기능 이벤트나 한글의 여러 기능을 예로 생각하면 이해하기 편할 것 같습니다.</p>
<p>참고</p>
<p><a href="https://en.wikipedia.org/wiki/Observer_pattern" target="_blank" rel="noopener">위키백과 옵서버패턴</a></p>
<p><a href="https://includestdio.tistory.com/39" target="_blank" rel="noopener">옵서버 방식 두가지</a></p>
<p><a href="https://doohyun.tistory.com/82" target="_blank" rel="noopener">https://doohyun.tistory.com/82</a></p>
<p><a href="https://www.dofactory.com/topic/1167/chain-of-responsibility-vs-observer-pattern.aspx" target="_blank" rel="noopener">로깅 - 옵저버 vs 책임연쇄</a></p>
<p><a href="http://ilkinulas.github.io/development/general/2016/04/17/observer-pattern.html" target="_blank" rel="noopener">옵서버패턴에서의 메모리릭</a></p>
<p><a href="https://glikmakesworld.tistory.com/3" target="_blank" rel="noopener">https://glikmakesworld.tistory.com/3</a> 예시</p>
<p><a href="https://nowonbun.tistory.com/480" target="_blank" rel="noopener">https://nowonbun.tistory.com/480</a> 실무</p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2020/02/21/Iterator_Pattern/" data-toggle="tooltip" data-placement="top" title="Iterator Pattern">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2020/02/21/SingleTon_Pattern/" data-toggle="tooltip" data-placement="top" title="Singleton Pattern">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">디자인 패턴</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">옵저버 패턴</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.0.1.</span> <span class="toc-nav-text">한계</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">So what can possibly go wrong?</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.1.1.</span> <span class="toc-nav-text">Always unregister your listeners unless they are interested in receiving notifications.</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.1.2.</span> <span class="toc-nav-text">그렇다면 어디에 사용해볼까?</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.1.3.</span> <span class="toc-nav-text">사용처?</span></a></li></ol></li></ol></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Design Pattern" title="Design Pattern">Design Pattern</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="http://beantech.org" target="_blank">Bean Tech</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/HanHoRang">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; HoRang 2020 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://beantech.org">BeanTech</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=YenYuHsuan&repo=hexo-theme-beantech&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://hanhorang.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://hanhorang.github.io/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
